
#pragma omp loop
for (int i = 0; i < Ndim; i++) {
  xnew[i] = (double)0.0;
  for (int j = 0; j < Ndim; j++) {
    xnew[i] += A[j * Ndim + i] * xold[j] * (double)(i != j);
  }
  xnew[i] = (b[i] - xnew[i]) / A[i * Ndim + i];
}
